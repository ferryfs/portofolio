# ====================================================
# üõ°Ô∏è 1. SECURITY UTAMA (WAJIB ADA)
# ====================================================

# üö´ MATIKAN FITUR NGINTIP FOLDER
Options -Indexes

# üîí BLOKIR AKSES FILE SENSITIF & JSON CACHE
# Ini gabungan biar .env, koneksi.php, git, dan file json di cache gak bisa dibuka
<FilesMatch "^(koneksi\.php|\.env|\.git|composer\.lock|package\.lock)">
    Order allow,deny
    Deny from all
</FilesMatch>

# Blokir akses langsung ke file JSON (untuk folder cache)
<FilesMatch "\.(json)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# üõ°Ô∏è TAMENG BROWSER (SECURITY HEADERS)
<IfModule mod_headers.c>
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
</IfModule>

# ====================================================
# üöÄ 2. URL REWRITE & SYSTEM
# ====================================================
RewriteEngine On

# ‚ö†Ô∏è PAKSA HTTPS (Aktifkan nanti pas di Hosting)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# PENGECUALIAN: Jangan rewrite folder /apps/ (biar apps lama jalan normal)
RewriteCond %{REQUEST_URI} !^/apps/

# PRETTY URL: Hapus ekstensi .php di URL
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [L]

# 3. Custom Error Page
ErrorDocument 404 /index.php